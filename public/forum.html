<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PLM Navigation App - Forum</title>
    <link rel="stylesheet" href="forum.css"> <!-- if ayaw gumana lagay muna sa public yung css idk din y ayaw gumana pag nasa assets e  -->
    <link rel="stylesheet" href="assets/chatbot.css">
</head>
<body>
    <div class="top-ribbon">
        <div class="ribbon-button-container">
            <a href="assets/tour/tour.html" class="ribbon-button">360 VIEW</a>
        </div>
        <div class="ribbon-button-container">
            <a href="forum.html" class="ribbon-button">FORUM</a>
        </div>
        <div class="ribbon-button-container">
            <a href="schedule.html" class="ribbon-button">SCHEDULE</a>
        </div>
        <div class="ribbon-button-container">
            <a href="events.html" class="ribbon-button">EVENTS</a>        </div>
        <div class = "ribbon-button-container">
            <a href="user.html" class="ribbon-button">USER</a>
        </div>
    </div>
    
    <div class="forum-container">
        <h1>Forum</h1>
        <div class="chat-box" id="chat-box">
        </div>
        <div class="input-container">
            <textarea id="message-input" placeholder="Type your message here..."></textarea>
            <button onclick="sendMessage()">Send</button>
        </div>
    </div>
    <script>
        function sendMessage() {
            const messageInput = document.getElementById('message-input').value.trim();
    
            if (messageInput !== "") {
                displayMessage('send', messageInput);
    
                const xhr = new XMLHttpRequest();
                xhr.open('POST', 'includes/save_message.php', true);
                xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
                xhr.onreadystatechange = function() {
                    if (xhr.readyState === XMLHttpRequest.DONE) {
                        if (xhr.status === 200) {
                            console.log('Message saved successfully');
                            fetchChatHistory(); 
                        } else {
                            console.error('Failed to save message');
                        }
                    }
                };
                xhr.send('message=' + encodeURIComponent(messageInput));
            }
        }
    
        function displayMessage(type, message) {
            const chatBox = document.getElementById('chat-box');
            const messageElement = document.createElement('div');
            messageElement.className = 'chat-message ' + type;
            messageElement.innerText = message;
            chatBox.appendChild(messageElement);
            chatBox.scrollTop = chatBox.scrollHeight;
    
            setTimeout(() => {
                if (type === 'send') {
                    displayMessage('receive', message); 
                }
            }, 1000); 
        }
    
        function fetchChatHistory() {
        }
    </script>
    

<!-- Chatbot Part Start -->
    <!-- Button -->
    <div class="cb-button" onclick="showModal()">
        <img src="assets/img/chatbot_img.png" alt="Chatbot">
    </div>
    <!-- Overlay -->
    <div class="cb-overlay" id="cb-overlay" onclick="hideModal()"></div>
    <!-- Modal -->
    <div class="cb-modal" id="cb-modal">
        <span class="cb-close-button" onclick="hideModal()">x</span>
        <textarea rows="10" cols="30" placeholder="Type here..."></textarea>
    </div>
    <script src="assets/chatbot.js"></script>
    <!-- Chatbot Part End -->

    <script>
        function navigateTo(page) {
            alert('Navigating to ' + page);
            // wala logic pa
        }
    </script>

</body>
</html>
